# Order Management Service

## Description
This project is a Spring Boot microservice designed to manage orders. It provides RESTful APIs for creating, retrieving, and deleting orders. The service interacts with a database to store order information and can communicate with other microservices (e.g., a book service) via Feign clients.

## Technologies Used
- Java 17
- Spring Boot 3.2.2
- Spring Web
- Spring Data JPA
- Spring Cloud Netflix Eureka Client
- Spring Cloud OpenFeign
- Maven
- MySQL (for production/persistent storage)
- H2 (for testing)
- Lombok
- Spring Boot Actuator (for monitoring)
- Springdoc OpenAPI (for API documentation)
- Resilience4j (for fault tolerance)

## Features
- Create new orders.
- Retrieve a list of all orders.
- Retrieve a specific order by its ID.
- Delete an order by its ID.
- Input validation for order creation.
- Rate limiting for order creation requests.
- Integration with a Book service (via Feign) to fetch book details when an order is created.

## API Endpoints
The service exposes the following RESTful endpoints under the `/orders` base path:

- `GET /orders/`: Retrieves a list of all orders.
- `GET /orders/{orderId}`: Retrieves a specific order by its ID.
  - Example: `GET /orders/1`
- `POST /orders/order`: Creates a new order.
  - Request Body Example:
    ```json
    {
      "customerName": "John Doe",
      "bookId": 123,
      "orderStatus": "NEW"
    }
    ```
- `DELETE /orders/{orderId}`: Deletes an order by its ID.
  - Example: `DELETE /orders/1`

For detailed API documentation, please refer to the Swagger UI (see [API Documentation](#api-documentation) section).

## Setup and Installation

### Prerequisites
- Java Development Kit (JDK) 17 or later.
- Apache Maven 3.6.0 or later.
- MySQL server (optional, if you want to run with a persistent database instead of H2).

### Database Setup
By default, the application uses an H2 in-memory database for testing purposes (see `src/test/resources/application-test.properties`).
For development or production, you can configure it to use a MySQL database.
1. Ensure you have a MySQL server running.
2. Create a database, for example, `order_service_db`.
3. Update the `src/main/resources/application.properties` file with your MySQL connection details:
   ```properties
   spring.datasource.url=jdbc:mysql://localhost:3306/order_service_db
   spring.datasource.username=<your_mysql_username>
   spring.datasource.password=<your_mysql_password>
   spring.jpa.hibernate.ddl-auto=update # Or 'create' for initial setup
   ```

### Running the Application
1. Clone the repository:
   ```bash
   git clone <repository_url>
   cd order-management-service
   ```
2. Build the project using Maven:
   ```bash
   ./mvnw clean install
   ```
3. Run the application:
   ```bash
   ./mvnw spring-boot:run
   ```
The application will start on the configured port (default is 8080) and context path (default is `/order-management-service`).
You can access it at `http://localhost:8080/order-management-service`.

## Configuration
Key configuration properties can be found in `src/main/resources/application.properties`:

- `server.port`: The port on which the application runs.
- `spring.application.name`: Name of the service, used for service discovery (e.g., Eureka).
- `spring.datasource.url`, `spring.datasource.username`, `spring.datasource.password`: Database connection details.
- `spring.jpa.hibernate.ddl-auto`: Hibernate DDL mode (e.g., `update`, `validate`, `create`).
- `eureka.client.serviceUrl.defaultZone`: URL for the Eureka server for service registration and discovery.

## Error Handling
- The service uses Spring Boot's default error handling mechanisms.
- Custom exception handlers (`OrderNotFoundException`, `OrderStatusNotValidException`) are implemented in the `OrderController` to provide specific error responses for certain scenarios.
- Validation errors for request bodies are handled by `MethodArgumentNotValidException` handler in `OrderController`, returning a map of field errors.

## Resilience
- The service uses Resilience4j for fault tolerance.
- The `POST /orders/order` endpoint is protected by a `@RateLimiter` (`orderRateLimiter`) to prevent abuse.
- Feign client calls to the Book Management service are configured with a Resilience4j Circuit Breaker (`bookServiceCircuitBreaker`). Configuration details can be found in `application.properties`.

## API Documentation
Detailed API documentation is available via Swagger UI. Once the application is running, you can access it at:
[http://localhost:8080/order-management-service/swagger-ui.html](http://localhost:8080/order-management-service/swagger-ui.html)

---
*This README.md was generated by an AI assistant.*
